<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complex Battle Game</title>
    <style>
        body { margin: 0; display: flex; flex-direction: column; align-items: center; }
        canvas { border: 1px solid black; }
        #menu { margin-bottom: 20px; }
        #stats { position: absolute; top: 10px; left: 10px; }
    </style>
</head>
<body>

<div id="menu">
    <button onclick="startGame(1)">Player vs Player</button>
    <button onclick="startGame(2)">Player vs Computer</button>
</div>

<canvas id="gameCanvas" width="800" height="600"></canvas>
<div id="stats"></div>

<script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    let player1, player2;
    let isGameRunning = false, isPlayer1Turn = true;

    function Player(name, x, y, color) {
        this.name = name;
        this.x = x;
        this.y = y;
        this.health = 100;
        this.color = color;
        this.width = 50;
        this.height = 50;
    }

    function drawPlayer(player) {
        ctx.fillStyle = player.color;
        ctx.fillRect(player.x, player.y, player.width, player.height);
    }

    function updateStats() {
        document.getElementById("stats").innerText = `${player1.name}: ${player1.health} HP | ${player2.name}: ${player2.health} HP`;
    }

    function gameLoop() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawPlayer(player1);
        drawPlayer(player2);
        updateStats();

        if (player1.health <= 0 || player2.health <= 0) {
            isGameRunning = false;
            alert(player1.health <= 0 ? `${player2.name} wins!` : `${player1.name} wins!`);
            return;
        }

        requestAnimationFrame(gameLoop);
    }

    function startGame(mode) {
        isGameRunning = true;
        player1 = new Player("Player 1", 100, 100, "blue");
        player2 = mode === 1 ? new Player("Player 2", 600, 100, "red") : new Player("Computer", 600, 100, "red");

        window.addEventListener("keydown", (event) => {
            if (!isGameRunning) return;

            if (event.key === 'ArrowRight') player1.x += 10;
            if (event.key === 'ArrowLeft') player1.x -= 10;
            if (event.key === 'ArrowUp') player1.y -= 10;
            if (event.key === 'ArrowDown') player1.y += 10;

            if (event.key === ' ') {
                if(Math.abs(player1.x - player2.x) < 50 && Math.abs(player1.y - player2.y) < 50) {
                    player2.health -= 10;
                }
            }

            if (mode === 2 && isPlayer1Turn) {
                // Simple AI for Computer's turn
                setTimeout(() => {
                    if (player2.x > player1.x) player2.x -= 10;
                    else if (player2.x < player1.x) player2.x += 10;

                    if(Math.abs(player1.x - player2.x) < 50 && Math.abs(player1.y - player2.y) < 50) {
                        player1.health -= 10;
                    }
                    isPlayer1Turn = true;
                }, 1000);
                isPlayer1Turn = false;
            }

            updateStats();
        });

        gameLoop();
    }
</script>

</body>
</html>
